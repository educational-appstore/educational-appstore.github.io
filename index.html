<!-- ==========================================================
         "I LOVE THE SAWFISH" - Eric Zhu - Dec 16, 2025
    =========================================================== -->
<!DOCTYPE html>
<html lang="en" class="loading">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sawfish App Store</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">

    <!-- Apple PWA -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <link rel="apple-touch-icon" sizes="192x192" href="icons/icon-192.png">
</head>

<body>

    <!-- ==========================================================
         INSTALLATION SCREEN (Shown ONLY when NOT installed)
    =========================================================== -->
    <section data-screen="install" class="visible">
        <header class="install-header">
            <h1>Sawfish App Store</h1>
            <p class="subtitle">A fast, school-safe way to access games and student tools.</p>
        </header>

        <main class="install-content">

            <section class="intro-block">
                <h2>Why This Exists</h2>
                <p>
                    Many schools rely on managed app tools that can feel slow, limited, or missing the apps students actually use.
                </p>
                <p>
                    The <strong>Sawfish App Store</strong> is a clean, modern web app that feels like a real App Store,
                    built for school-safe fun and communication tools.
                </p>
            </section>

            <section class="how-it-works">
                <h2>How to Install</h2>
                <p>
                    This works best when added to your iPad’s Home Screen:
                </p>

                <ol class="install-steps">
                    <li>Tap the <strong>Share</strong> button in Safari.</li>
                    <li>Scroll down and tap <strong>Add to Home Screen</strong>.</li>
                    <li>Tap <strong>Add</strong>.</li>
                    <li>Open the Sawfish App Store from your Home Screen icon.</li>
                </ol>
            </section>

            <section class="benefits">
                <h2>What Installation Unlocks</h2>
                <p>When installed, you get:</p>

                <ul class="benefit-list">
                    <li><strong>Game Hub</strong> — a curated set of school-friendly games.</li>
                    <li><strong>Social tools</strong> — chat and call portals in one place.</li>
                    <li><strong>Full-screen app feel</strong> — faster and more “native”.</li>
                    <li><strong>Smoother navigation</strong> — clean iOS-style sections.</li>
                </ul>
            </section>

            <section class="final-note">
                <p>
                    After installation, this setup screen disappears and the full app becomes available.
                </p>
            </section>
        </main>

        <footer class="install-footer">
            <p>Built by the Sawfish Developer Group · <span id="install-version">Version</span></p>
        </footer>
    </section>

    <!-- ==========================================================
         FULL APP SCREEN (Shown ONLY after PWA installation)
    =========================================================== -->
    <section data-screen="app">

        <!-- TOP NAV (App Title) -->
        <header class="app-header">
            <div class="app-header-row">
                <h1>Sawfish App Store</h1>

                <!-- PWA-ONLY BANNER (hidden unless installed PWA) -->
                <div id="pwa-banner" class="pwa-banner" aria-hidden="true">
                    <div class="pwa-banner-left">
                        <div class="pwa-badge">PWA</div>
                        <div class="pwa-banner-text">
                            <div class="pwa-banner-title">App status</div>
                            <div class="pwa-banner-sub" id="update-status">Checking for updates…</div>
                        </div>
                    </div>
                    <button id="update-action" class="pwa-banner-btn" type="button">Up to date</button>
                </div>
            </div>
        </header>

        <!-- TAB BAR (Home / Games / Connect / OS) -->
        <nav class="tab-bar">
            <button data-tab="home" class="active">Home</button>
            <button data-tab="games">Games</button>
            <button data-tab="connect">Social</button>
            <button data-tab="os">OS</button>
        </nav>

        <!-- PAGE: HOME -->
        <main data-page="home" class="visible">
            <section class="home-hero">
                <h2>Welcome</h2>
                <p>
                    Thanks for installing the Sawfish App Store.
                    Open games and student tools in one clean place.
                </p>
            </section>

            <section class="featured-section">
                <h3>Featured Apps</h3>
                <div class="card-grid">

                    <article class="app-card">
                        <h4>Hack Stuff</h4>
                        <p class="muted">Protected area. Use only if you have permission.</p>
                        <div class="pill-row">
                            <span class="pill">Password: 0128</span>
                        </div>
                        <a class="app-launch" href="https://the-sawfish.github.io/hack/" target="_blank" rel="noopener noreferrer">
                            Open
                        </a>
                    </article>

                    <article class="app-card">
                        <h4>Sawfish Game Portal</h4>
                        <p>A collection of school-friendly games.</p>
                        <a class="app-launch" href="https://the-sawfish.github.io/game-portal/" target="_blank" rel="noopener noreferrer">
                            Open Game Portal
                        </a>
                    </article>

                    <article class="app-card">
                        <h4>Chat App</h4>
                        <p>Message classmates in real time.</p>
                        <a class="app-launch" href="https://jimeneutron.github.io/chatapp/" target="_blank" rel="noopener noreferrer">
                            Open Chat
                        </a>
                    </article>

                    <article class="app-card">
                        <h4>Call App</h4>
                        <p>Fast, simple calling interface.</p>
                        <a class="app-launch" href="https://the-sawfish.github.io/call-app/?from=sawfish" target="_blank" rel="noopener noreferrer">
                            Open Call App
                        </a>
                    </article>

                </div>
            </section>

            <!-- CHANGELOG / UPDATE INFO -->
            <section class="changelog">
                <div class="changelog-header">
                    <h3>Changelog</h3>
                    <div class="changelog-meta">
                        <span class="meta-chip" id="app-version-chip">Version</span>
                        <span class="meta-chip" id="last-check-chip">Last check: —</span>
                    </div>
                </div>

                <div class="changelog-body">
                    <p class="muted">
                        This section updates when you publish changes to the site.
                        If your device is still showing an old version, use the update button in the banner.
                    </p>

                    <!-- Placeholder entries (edit any time) -->
                    <div class="changelog-entry">
                        <div class="changelog-date">Latest</div>
                        <ul>
                            <li>Improved layout and styling.</li>
                            <li>Added first-time setup notice (scroll + acknowledge).</li>
                            <li>Improved update behavior (service worker refresh).</li>
                        </ul>
                    </div>

                    <div class="changelog-entry">
                        <div class="changelog-date">Previous</div>
                        <ul>
                            <li>Chat app: fixed an issue that caused failure on certain devices.</li>
                        </ul>
                    </div>
                </div>
            </section>
        </main>

        <!-- PAGE: GAMES (Offline merged in here to avoid duplicate data-page="games") -->
        <main data-page="games">
            <section class="page-header">
                <h2>Games</h2>
                <p>Welcome to the Sawfish Game Hub.</p>
            </section>

            <section class="info-callout">
                <h3>Offline (Add to Home Screen Required)</h3>
                <p class="muted">
                    Some games support offline or work best when installed to your Home Screen.
                    If something doesn’t load, make sure you opened the installed app (not Safari preview).
                </p>
            </section>

            <section class="game-list">
                <article class="game-card">
                    <h4>Draw a Circle</h4>
                    <p>Quick challenge game. Add to Home Screen for best experience.</p>
                    <a class="app-launch" href="https://the-sawfish.github.io/circle/" target="_blank" rel="noopener noreferrer">
                        Open
                    </a>
                </article>

                <article class="game-card">
                    <h4>2048</h4>
                    <p>The classic number puzzle.</p>
                    <a class="app-launch" href="https://the-sawfish.github.io/2048/" target="_blank" rel="noopener noreferrer">
                        Play
                    </a>
                </article>

                <article class="game-card">
                    <h4>Minecraft (Web) — Beta</h4>
                    <p>Not the full Minecraft. Use multiplayer servers for crafting features.</p>
                    <a class="app-launch" href="https://zardoy.github.io/minecraft-web-client/" target="_blank" rel="noopener noreferrer">
                        Play
                    </a>
                </article>

                <article class="game-card">
                    <h4>Block Blast</h4>
                    <p>Quick puzzle / block game.</p>
                    <a class="app-launch" href="https://aappqq.github.io/BlockBlast/index.html" target="_blank" rel="noopener noreferrer">
                        Play
                    </a>
                </article>

                <article class="game-card">
                    <h4>Sandboxels</h4>
                    <p>Falling sand simulator with lots of materials. Add to Home Screen for best results.</p>
                    <a class="app-launch" href="https://the-sawfish.github.io/sandboxels/" target="_blank" rel="noopener noreferrer">
                        Play
                    </a>
                </article>

                <article class="game-card">
                    <h4>Sawfish Game Portal</h4>
                    <p>Instant access to school-friendly titles.</p>
                    <a class="app-launch" href="https://the-sawfish.github.io/game-portal/" target="_blank" rel="noopener noreferrer">
                        Launch
                    </a>
                </article>

                <article class="game-card">
                    <h4>Syrup Games</h4>
                    <p>Alternative game launcher.</p>
                    <a class="app-launch"
                       href="https://jimeneutron.github.io/"
                       target="_blank"
                       rel="noopener noreferrer">
                        Open
                    </a>
                </article>

                <article class="game-card">
                    <h4>Bob The Robber</h4>
                    <p>Stealth game classic.</p>
                    <a class="app-launch" href="https://bobtherobberunblocked.github.io/2/" target="_blank" rel="noopener noreferrer">
                        Play
                    </a>
                </article>

                <article class="game-card">
                    <h4>Retro Bowl</h4>
                    <p>Football management game.</p>
                    <a class="app-launch"
                       href="https://the-sawfish.github.io/seraph/games/retrobowl/index.html"
                       target="_blank"
                       rel="noopener noreferrer">
                        Open
                    </a>
                </article>

                <article class="game-card">
                    <h4>Paper Io 2</h4>
                    <p>Capture territory and survive.</p>
                    <a class="app-launch" href="https://the-sawfish.github.io/seraph/games/paperio2/index.html" target="_blank" rel="noopener noreferrer">
                        Open
                    </a>
                </article>

                <article class="game-card">
                    <h4>Run 3</h4>
                    <p>Full-screen Run 3. Progress saves locally (does not sync).</p>
                    <a class="app-launch" href="https://the-sawfish.github.io/Run3Final/" target="_blank" rel="noopener noreferrer">
                        Play
                    </a>
                </article>
            </section>
        </main>

        <!-- PAGE: CONNECT -->
        <main data-page="connect">
            <section class="page-header">
                <h2>Social</h2>
                <p>All communication tools in one place.</p>
            </section>

            <section class="connect-list">
                <article class="connect-card">
                    <h4>Chat App</h4>
                    <p>Real-time messaging for students.</p>
                    <a class="app-launch" href="https://jimeneutron.github.io/chatapp/" target="_blank" rel="noopener noreferrer">
                        Open Chat
                    </a>
                </article>

                <article class="connect-card">
                    <h4>Call App</h4>
                    <p>Fast, simple calling interface.</p>
                    <a class="app-launch" href="https://the-sawfish.github.io/call-app/?from=sawfish" target="_blank" rel="noopener noreferrer">
                        Open Call App
                    </a>
                </article>
            </section>
        </main>

        <!-- PAGE: OS -->
        <main data-page="os">
            <section class="page-header">
                <h2>Operating Systems</h2>
                <p>Previews are non-interactive. Add to Home Screen to use fully.</p>
            </section>

            <section class="os-list">

                <article class="os-card">
                    <h4>NovaOS</h4>
                    <div class="os-container">
                        <iframe src="https://runnova.github.io/NovaOS/" frameborder="0"></iframe>
                        <div class="overlay">
                            <h2>Preview Disabled</h2>
                            <p>You can’t interact here. Install to Home Screen to use fully.</p>
                        </div>
                    </div>
                    <a class="app-launch" href="https://runnova.github.io/NovaOS/" target="_blank" rel="noopener noreferrer">
                        Open NovaOS
                    </a>
                </article>

                <article class="os-card">
                    <h4>WinRipen</h4>
                    <div class="os-container">
                        <iframe src="https://ripenos.web.app/WinRipen/index.html" frameborder="0"></iframe>
                        <div class="overlay">
                            <h2>Preview Disabled</h2>
                            <p>You can’t interact here. Install to Home Screen to use fully.</p>
                        </div>
                    </div>
                    <a class="app-launch" href="https://ripenos.web.app/WinRipen/index.html" target="_blank" rel="noopener noreferrer">
                        Open WinRipen
                    </a>
                </article>

                <article class="os-card">
                    <h4>PlutoOS</h4>
                    <div class="os-container">
                        <iframe src="https://pluto-app.zeon.dev" frameborder="0"></iframe>
                        <div class="overlay">
                            <h2>Preview Disabled</h2>
                            <p>You can’t interact here. Install to Home Screen to use fully.</p>
                        </div>
                    </div>
                    <a class="app-launch" href="https://pluto-app.zeon.dev" target="_blank" rel="noopener noreferrer">
                        Run PlutoOS
                    </a>
                </article>

                <article class="os-card">
                    <h4>Ripenos</h4>
                    <div class="os-container">
                        <iframe src="https://ripenos.web.app/Ripenos/" frameborder="0"></iframe>
                        <div class="overlay">
                            <h2>Preview Disabled</h2>
                            <p>You can’t interact here. Install to Home Screen to use fully.</p>
                        </div>
                    </div>
                    <a class="app-launch" href="https://ripenos.web.app/Ripenos/" target="_blank" rel="noopener noreferrer">
                        Open Ripenos
                    </a>
                </article>

            </section>
        </main>

    </section>

    <!-- ADD TO HOME SCREEN NOTICE (Safari preview only) -->
    <div id="a2hs-modal" class="a2hs-hidden">
        <div class="a2hs-box">
            <h1>Add to Home Screen</h1>
            <p>
                The Sawfish App Store works best when installed.
                Some features are limited in preview mode.
            </p>
            <p class="small">
                Installing gives full-screen mode, faster loading,
                and the best experience.
            </p>
            <button id="a2hs-close">Continue</button>
        </div>
    </div>

    <!-- FIRST-TIME / RETURNING WELCOME MODAL (PWA only) -->
    <div id="welcome-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="welcome-title">
        <div class="modal-card">
            <div class="modal-header">
                <h2 id="welcome-title">Read This First</h2>
                <p class="muted" id="welcome-subtitle">One-time setup message</p>
            </div>

            <!-- First-time: scroll required -->
            <div id="welcome-scrollwrap" class="modal-scroll">
                <div class="modal-content">
                    <h3>Minecraft Important Rule</h3>
                    <p>
                        In Minecraft Web, <strong>do not use single player</strong>.
                        You <strong>must use a multiplayer server</strong> to be able to craft.
                        Prefer the <strong>official first server</strong> when available.
                    </p>

                    <h3>Add Apps for Best Experience</h3>
                    <p>
                        For the smoothest experience, add important apps to your Home Screen when possible.
                        Some apps require installation to work well (fullscreen, faster load, better reliability).
                    </p>

                    <h3>Changelog & Updates</h3>
                    <p>
                        This app improves over time. Check the <strong>Changelog</strong> on the Home tab.
                        If you ever see old content, use the <strong>Update</strong> button in the top banner.
                    </p>

                    <div class="spacer"></div>
                    <p class="muted">
                        (Placeholders for now: later you can add exact steps, links, and policies here.)
                    </p>
                    <div class="scroll-end-marker" aria-hidden="true"></div>
                </div>
            </div>

            <!-- Returning: no scroll required (hidden via JS) -->
            <div id="welcome-returning" class="modal-returning hidden">
                <p class="muted">
                    Welcome back. Tap Continue to enter the app.
                </p>
            </div>

            <div class="modal-footer">
                <label id="welcome-ack-row" class="ack-row hidden">
                    <input id="welcome-ack" type="checkbox">
                    <span>I understand</span>
                </label>

                <button id="welcome-continue" class="primary-btn" type="button" disabled>Continue</button>
            </div>
        </div>
    </div>

    <!-- SETUP SCRIPT -->
    <script>
        document.documentElement.classList.remove("loading");

        document.querySelectorAll('.os-container iframe').forEach(iframe => {
            iframe.addEventListener('load', () => {
                const overlay = iframe.parentElement.querySelector('.overlay');
                if (overlay) overlay.classList.add('visible');
            });
        });
    </script>

    <script src="app.js"></script>

</body>
</html>
